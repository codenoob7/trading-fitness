# shared-types package - mise configuration
# JSON Schema type definitions for polyglot code generation
# Inherits from root mise.toml

[env]
# Package-specific environment
SHARED_TYPES_DIR = "{{config_root}}"

# =============================================================================
# Type Generation Tasks
# =============================================================================

[tasks.generate]
description = "Generate types from JSON Schema (all languages)"
run = "bash ../../scripts/generate-types.sh all"

[tasks."generate:python"]
description = "Generate Python types from JSON Schema"
run = "bash ../../scripts/generate-types.sh python"

[tasks."generate:typescript"]
description = "Generate TypeScript types from JSON Schema"
run = "bash ../../scripts/generate-types.sh typescript"

[tasks."generate:rust"]
description = "Generate Rust types from JSON Schema"
run = "bash ../../scripts/generate-types.sh rust"

# =============================================================================
# Validation Tasks
# =============================================================================

[tasks.validate]
description = "Validate JSON Schema files"
run = """
echo "Validating JSON Schema files..."
for schema in schemas/*.json; do
    echo "  Checking $schema..."
    # Use ajv or jsonschema-cli if available
    python3 -c "import json; json.load(open('$schema'))" || exit 1
done
echo "âœ… All schemas valid"
"""

[tasks.lint]
description = "Lint schema files with prettier"
run = "npx prettier --check schemas/*.json"

[tasks."lint:fix"]
description = "Fix schema formatting with prettier"
run = "npx prettier --write schemas/*.json"
